## 3.3 Реализация модуля интеллектуальной обработки обращений (intent classification)

AI-компонент проекта tg-shop-ai реализован как прототип модуля интеллектуальной обработки обращений пользователя в свободной форме. Назначение модуля — повысить удобство взаимодействия с магазином: пользователь может сформулировать запрос текстом, а система возвращает подсказку (рекомендации по товарам, переход к каталогу, объяснение, как оформить покупку). В текущей версии используется правил-ориентированная классификация намерений (intent classification) и шаблонная генерация ответов на основе данных каталога.

### Обработка запроса и определение интента
Запрос инициируется командой `/ai <текст>`. На первом шаге выполняется нормализация текста (удаление лишних пробелов, приведение к нижнему регистру). Далее выполняется определение интента по ключевым словам и маркерам запроса. В зависимости от распознанного интента выбирается сценарий формирования ответа: рекомендации товаров, подсказка по просмотру каталога, помощь по оформлению заказа или нейтральный ответ для неопределённых запросов.

### Формирование ответа на основе данных каталога
Для интента «рекомендация/подбор» выполняется выборка активных товаров из базы данных (таблица `products`), после чего формируется краткий список предложений (например, top-N) и выдаётся подсказка команды оформления покупки (`/buy <SKU>`). Для интентов «каталог/товары» и «помощь по покупке» формируются инструкции по дальнейшим действиям (переход к `/catalog` и пример использования `/buy`). Для неопределённого интента возвращается пример корректного запроса и перечень доступных команд.

### Логирование и трассируемость
Каждый запрос `/ai` и сформированный ответ сохраняются в таблицу `ai_logs` (например: `user_id`, `prompt`, `response`, `created_at`). Это обеспечивает трассируемость поведения интеллектуального компонента и позволяет анализировать обращения пользователей, проверять корректность правил распознавания и улучшать сценарии ответов.

Таким образом, AI-модуль в составе tg-shop-ai демонстрирует интеграцию интеллектуальной обработки обращений с базой данных и основными пользовательскими сценариями магазина, сохраняя воспроизводимость и прозрачность логики работы прототипа.
