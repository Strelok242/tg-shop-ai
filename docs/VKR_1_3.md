1.3 Постановка задачи и требования к системе

На основе анализа предметной области и существующих решений формулируется задача разработки прототипа Telegram-приложения интернет-магазина с интеграцией интеллектуального помощника. Система должна обеспечивать единый контур хранения данных (товары, пользователи, заказы), поддерживать основные пользовательские сценарии через Telegram-бота и предоставлять веб-интерфейс для просмотра данных и управления каталогом. Интеллектуальный модуль в рамках прототипа реализуется в виде рекомендательного/подсказочного компонента; при этом обязательным является журналирование запросов и ответов для последующего анализа и улучшения качества рекомендаций.

Требования к системе разделяются на функциональные (описывают, что система делает) и нефункциональные (описывают, как система должна работать: надёжность, безопасность, удобство, ограничения платформы). Свод требований представлен в таблице 1.

Таблица 1 — Требования к системе tg-shop-ai

| ID  | Требование                                                                                      | Тип | Приоритет | Проверка                                              |
| --- | ----------------------------------------------------------------------------------------------- | --- | --------- | ----------------------------------------------------- |
| F1  | Регистрация пользователя по команде `/start` с сохранением `tg_id` и `username` в БД            | F   | MUST      | Демо: `/start` + `SELECT users`                       |
| F2  | Просмотр каталога товаров по команде `/catalog` (название, SKU, цена)                           | F   | MUST      | Демо: `/catalog`                                      |
| F3  | Оформление заказа по команде `/buy <SKU>` с созданием заказа и позиции заказа                   | F   | MUST      | Демо: `/buy` + `SELECT orders/order_items`            |
| F4  | Корректный расчёт суммы заказа на основе `qty` и `price_cents`                                  | F   | MUST      | Демо: сравнить ответ бота и данные БД                 |
| F5  | Просмотр истории заказов пользователя по команде `/myorders`                                    | F   | MUST      | Демо: `/myorders`                                     |
| F6  | Интеллектуальная команда `/ai <текст>` с формированием ответа-подсказки                         | F   | SHOULD    | Демо: `/ai`                                           |
| F7  | Логирование AI-запросов и ответов в `ai_logs` (`prompt`, `response`, `user_id`, `created_at`)   | F   | MUST      | Демо: `SELECT ai_logs`                                |
| F8  | Веб-страница `/catalog` с отображением каталога из БД                                           | F   | MUST      | Демо: открыть `/catalog`                              |
| F9  | Веб-страница `/orders?tg_id=<id>` с отображением заказов пользователя                           | F   | SHOULD    | Демо: открыть `/orders?tg_id=...`                     |
| F10 | Админ-страница `/admin/products`: добавление товара (SKU, название, цена, описание, активность) | F   | MUST      | Демо: добавить товар и увидеть в списке               |
| F11 | Команда инициализации БД `init-db`: создание таблиц при отсутствии                              | F   | MUST      | Проверка: удалить `app.db`, запустить `init-db`       |
| F12 | Команда заполнения тестовыми товарами `seed-products` без дублей                                | F   | SHOULD    | Проверка: повторный запуск → “already exist”          |
| N1  | Хранение секретов (BOT_TOKEN) только в `.env`, запрет коммита секретов                          | N   | MUST      | Инспекция: `.gitignore` + отсутствует `.env` в GitHub |
| N2  | Стабильный запуск по инструкции `README` (venv, requirements, команды запуска)                  | N   | MUST      | Проверка: “чистый запуск” по README                   |
| N3  | Целостность данных: заказ не создаётся для неизвестного пользователя (без `/start`)             | N   | MUST      | Тест: `/buy` без `/start` → сообщение об ошибке       |
| N4  | Валидация: `qty >= 1`, проверка существования SKU                                               | N   | MUST      | Тест: `/buy` неверный SKU → сообщение                 |
| N5  | Модульная структура проекта (bot/web/db/ai) для сопровождаемости                                | N   | SHOULD    | Инспекция структуры папок                             |
| N6  | Хранение данных в SQL-БД (SQLite на этапе прототипа)                                            | N   | MUST      | Инспекция: `app.db` и модели SQLAlchemy               |
| N7  | Логи/ошибки не раскрывают токены и чувствительные данные                                        | N   | MUST      | Инспекция вывода/логов                                |
| N8  | Производительность: ответы бота на базовые команды ≤ 2 сек при локальном запуске                | N   | SHOULD    | Демо: ручная проверка                                 |
| N9  | Кроссплатформенность запуска в Windows (Python 3.11, PowerShell)                                | N   | MUST      | Демо: запуск в текущей среде                          |
| N10 | Воспроизводимость: `seed-products` и `init-db` разворачивают базу “с нуля”                      | N   | MUST      | Проверка: сценарий “с нуля”                           |
